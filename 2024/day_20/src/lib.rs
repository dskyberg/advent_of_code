use anyhow::Result;
use pathfinding::prelude::astar;
use std::str::FromStr;
use thiserror::Error;

use aoc_utils::*;

#[derive(Debug, Error)]
pub enum Error {
    #[error("Failed to parse string")]
    FromStr(#[from] MatrixError),
    #[error("Start not found")]
    StartNotFound,
    #[error("End not found")]
    EndNotFound,
    #[error("Race track search error")]
    BadRaceTrack,
    #[error("From anyhow")]
    Anyhow(#[from] anyhow::Error),
}

/// Use a* to get the known good path.
fn get_racetrack(matrix: &Matrix<u8>, start: &Point, end: &Point) -> Result<Vec<Point>> {
    let successors = |p: &Point| -> Vec<(Point, usize)> {
        matrix
            .neighbors(p)
            .into_iter()
            .filter(|p| matrix.get_unsafe(p) != b'#')
            .map(|p| (p, 1))
            .collect()
    };
    let heuristic = |p: &Point| -> usize {
        let distance = end.distance(p);
        (distance.x + distance.y) as usize
    };
    let success = |p: &Point| p == end;

    // Since we know there's a path, just unwrap
    let (points, _) = astar(start, successors, heuristic, success).ok_or(Error::BadRaceTrack)?;
    Ok(points)
}

pub struct Race {
    pub matrix: Matrix<u8>,
    pub track: Vec<Point>,
    pub start: Point,
    pub end: Point,
}

impl Race {
    pub fn solve(&self, max_cheat: usize, savings_target: usize) -> Result<usize> {
        // Get the one good path
        let mut cheats = 0;
        for (start_idx, start) in self.track.iter().enumerate() {
            for (end_idx, end) in self
                .track
                .iter()
                .enumerate()
                .skip(start_idx + savings_target)
            {
                let diff =
                    start.horizontal_distance(end) as usize + start.vertical_distance(end) as usize;

                if diff <= max_cheat && (end_idx - start_idx) - diff >= savings_target {
                    cheats += 1;
                }
            }
        }

        Ok(cheats)
    }
}

impl FromStr for Race {
    type Err = Error;
    fn from_str(s: &str) -> Result<Self, Self::Err> {
        let mut matrix = s.parse::<Matrix<u8>>()?;

        let start = matrix.find_one(&b'S').ok_or(Error::StartNotFound)?;
        matrix.set_unsafe(&start, b'.');

        let end = matrix.find_one(&b'E').ok_or(Error::EndNotFound)?;
        matrix.set_unsafe(&end, b'.');
        let track = get_racetrack(&matrix, &start, &end)?;

        Ok(Self {
            matrix,
            start,
            end,
            track,
        })
    }
}

pub static TEST_INPUT: &str = r#"###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############"#;

pub static INPUT: &str = r#"#############################################################################################################################################
#.......###...###...#.....#...#.....#...#.....#...#...#.....#.........#...###...#...###.........#.......###...#...###.........#.....#.......#
#.#####.###.#.###.#.#.###.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#######.#.#.###.#.#.#.###.#######.#.#####.###.#.#.#.###.#######.#.###.#.#####.#
#.#...#.....#.#...#.#.#...#.#.#...#.#.#.#...#.#.#.#.#.#.#...#.......#...#...#.#.#.#...#.....#...#...#...#...#...#...#.......#.#.#...#.#.....#
#.#.#.#######.#.###.#.#.###.#.###.#.#.#.###.#.#.#.#.#.#.#.#########.#######.#.#.#.###.#####.#.#####.#.###.#########.#######.#.#.#.###.#.#####
#...#.......#.#...#...#.#...#.#...#.#.#.#...#.#.#.#.#.#.#.......###.....#...#.#.#...#.#...#.#...###.#...#...#.......#...###.#.#.#.#...#.....#
###########.#.###.#####.#.###.#.###.#.#.#.###.#.#.#.#.#.#######.#######.#.###.#.###.#.#.#.#.###.###.###.###.#.#######.#.###.#.#.#.#.#######.#
#.......#...#.....#.....#...#.#...#.#.#.#.#...#.#.#.#.#.#.......#.......#...#.#...#.#.#.#.#...#.....#...###.#.........#.....#...#...#.......#
#.#####.#.#########.#######.#.###.#.#.#.#.#.###.#.#.#.#.#.#######.#########.#.###.#.#.#.#.###.#######.#####.#########################.#######
#.....#.#...#.....#.#...###.#.#...#.#.#...#.#...#.#.#.#.#...#...#.......#...#.#...#.#.#.#.#...#.......#...#.#.....#.....#...#.....#...###...#
#####.#.###.#.###.#.#.#.###.#.#.###.#.#####.#.###.#.#.#.###.#.#.#######.#.###.#.###.#.#.#.#.###.#######.#.#.#.###.#.###.#.#.#.###.#.#####.#.#
#...#.#...#...#...#.#.#...#.#.#...#.#...#...#...#...#.#.#...#.#.........#...#.#.###.#...#.#...#...#...#.#...#...#.#.###...#...###...###...#.#
#.#.#.###.#####.###.#.###.#.#.###.#.###.#.#####.#####.#.#.###.#############.#.#.###.#####.###.###.#.#.#.#######.#.#.###################.###.#
#.#.#...#.....#...#.#...#.#.#.....#.....#...###.....#.#.#.###.............#.#.#...#...#...#...#...#.#.#.#.......#...#...###...###...#...#...#
#.#.###.#####.###.#.###.#.#.###############.#######.#.#.#.###############.#.#.###.###.#.###.###.###.#.#.#.###########.#.###.#.###.#.#.###.###
#.#...#.#.....###.#.###.#.#.......#.....#...#...###.#...#...###...#.....#.#...#...###.#...#...#.#...#...#.........#...#.#...#...#.#.#.#...###
#.###.#.#.#######.#.###.#.#######.#.###.#.###.#.###.#######.###.#.#.###.#.#####.#####.###.###.#.#.###############.#.###.#.#####.#.#.#.#.#####
#...#...#...###...#.#...#.#...###...#...#.#...#...#.#.......#...#.#...#.#.#.....#...#...#.#...#...#...............#.#...#.....#.#.#.#.#.#...#
###.#######.###.###.#.###.#.#.#######.###.#.#####.#.#.#######.###.###.#.#.#.#####.#.###.#.#.#######.###############.#.#######.#.#.#.#.#.#.#.#
###...#...#...#...#.#...#...#.#...###.#...#.....#...#.#...###...#.#...#.#.#...###.#.#...#.#.......#...#...#.....###.#...#...#.#...#.#.#...#.#
#####.#.#.###.###.#.###.#####.#.#.###.#.#######.#####.#.#.#####.#.#.###.#.###.###.#.#.###.#######.###.#.#.#.###.###.###.#.#.#.#####.#.#####.#
#.....#.#...#.....#.....#.....#.#.#...#.....#...#.....#.#.#...#.#.#...#.#.#...#...#.#...#...#.....#...#.#.#...#...#.#...#.#.#.#.....#.#...#.#
#.#####.###.#############.#####.#.#.#######.#.###.#####.#.#.#.#.#.###.#.#.#.###.###.###.###.#.#####.###.#.###.###.#.#.###.#.#.#.#####.#.#.#.#
#.....#...#...#...#.....#.###...#.#...#.....#...#.#...#.#...#...#.....#...#...#...#...#...#.#.....#...#.#...#...#.#.#.....#.#.#.#...#.#.#...#
#####.###.###.#.#.#.###.#.###.###.###.#.#######.#.#.#.#.#####################.###.###.###.#.#####.###.#.###.###.#.#.#######.#.#.#.#.#.#.#####
#...#.#...###...#...#...#.....#...#...#.#...#...#.#.#.#...#.................#...#...#.#...#...#...#...#.#...#...#...#.....#...#...#.#.#.....#
#.#.#.#.#############.#########.###.###.#.#.#.###.#.#.###.#.###############.###.###.#.#.#####.#.###.###.#.###.#######.###.#########.#.#####.#
#.#.#...#...........#.........#...#...#.#.#.#...#.#.#...#...#.....#...#...#...#...#.#.#...#...#...#...#.#.#...#...#...###...........#...#...#
#.#.#####.#########.#########.###.###.#.#.#.###.#.#.###.#####.###.#.#.#.#.###.###.#.#.###.#.#####.###.#.#.#.###.#.#.###################.#.###
#.#...###.........#...###...#...#...#.#...#.....#.#...#.#...#...#.#.#...#.###...#.#.#.....#.#...#...#...#.#.#...#...#...###...#.........#.###
#.###.###########.###.###.#.###.###.#.###########.###.#.#.#.###.#.#.#####.#####.#.#.#######.#.#.###.#####.#.#.#######.#.###.#.#.#########.###
#.#...#...#...#...#...#...#.....#...#...#...#.....#...#.#.#.#...#.#.#.....#...#.#.#...#...#.#.#...#.#...#...#.......#.#...#.#...#.......#...#
#.#.###.#.#.#.#.###.###.#########.#####.#.#.#.#####.###.#.#.#.###.#.#.#####.#.#.#.###.#.#.#.#.###.#.#.#.###########.#.###.#.#####.#####.###.#
#.#.....#...#.#...#.###.....#...#.#...#...#.#.#...#...#.#.#.#...#.#.#.#...#.#.#.#.###...#.#.#...#.#.#.#.....#...#...#.#...#.#.....#...#...#.#
#.###########.###.#.#######.#.#.#.#.#.#####.#.#.#.###.#.#.#.###.#.#.#.#.#.#.#.#.#.#######.#.###.#.#.#.#####.#.#.#.###.#.###.#.#####.#.###.#.#
#.#.........#.....#.....###...#.#.#.#...#...#.#.#...#.#.#.#...#.#.#.#...#.#.#.#.#...#...#.#.#...#.#.#.#...#...#...#...#.#...#.......#...#...#
#.#.#######.###########.#######.#.#.###.#.###.#.###.#.#.#.###.#.#.#.#####.#.#.#.###.#.#.#.#.#.###.#.#.#.#.#########.###.#.#############.#####
#.#.#.......#.........#...#.....#...#...#...#...###...#.#...#.#.#...#.....#.#.#...#.#.#.#.#.#...#.#.#.#.#.....#...#...#.#.#...........#.....#
#.#.#.#######.#######.###.#.#########.#####.###########.###.#.#.#####.#####.#.###.#.#.#.#.#.###.#.#.#.#.#####.#.#.###.#.#.#.#########.#####.#
#...#.........#...###...#...#...#...#.....#.........#...#...#.#.....#.#...#.#...#.#.#.#.#.#...#.#...#...#.....#.#.#...#...#.#.......#...#...#
###############.#.#####.#####.#.#.#.#####.#########.#.###.###.#####.#.#.#.#.###.#.#.#.#.#.###.#.#########.#####.#.#.#######.#.#####.###.#.###
#...........#...#.#.....#...#.#...#.....#...#...#...#...#...#.#.....#...#.#...#.#.#.#.#.#.###...###...###.....#.#.#.#.....#...#...#...#.#...#
#.#########.#.###.#.#####.#.#.#########.###.#.#.#.#####.###.#.#.#########.###.#.#.#.#.#.#.#########.#.#######.#.#.#.#.###.#####.#.###.#.###.#
#...#.....#.#...#...#...#.#...#.........###...#...###...#...#.#.#.........#...#...#...#.#.....#.....#.......#...#...#...#.#.....#.#...#.#...#
###.#.###.#.###.#####.#.#.#####.#####################.###.###.#.#.#########.###########.#####.#.###########.###########.#.#.#####.#.###.#.###
###...#...#...#.....#.#.#...#...#...#...#...#...#...#...#...#...#.#...#...#.........#...#.....#.......#...#.............#.#.....#.#...#.#.###
#######.#####.#####.#.#.###.#.###.#.#.#.#.#.#.#.#.#.###.###.#####.#.#.#.#.#########.#.###.###########.#.#.###############.#####.#.###.#.#.###
#.......#...#.......#.#.#...#.....#...#...#...#.#.#.###.....#...#...#.#.#.#...#...#.#...#...#########...#.............###.......#.....#.#...#
#.#######.#.#########.#.#.#####################.#.#.#########.#.#####.#.#.#.#.#.#.#.###.###.#########################.#################.###.#
#.#...#...#...#.......#...#...#.................#.#.#.........#...#...#.#.#.#.#.#.#...#...#.###################.......#...#...........#.....#
#.#.#.#.#####.#.###########.#.#.#################.#.#.###########.#.###.#.#.#.#.#.###.###.#.###################.#######.#.#.#########.#######
#.#.#...#...#...#...#...#...#...#...#...###.......#...#.....#...#.#...#.#.#.#.#.#.#...#...#.###################...#.....#...#.........#.....#
#.#.#####.#.#####.#.#.#.#.#######.#.#.#.###.###########.###.#.#.#.###.#.#.#.#.#.#.#.###.###.#####################.#.#########.#########.###.#
#...###...#.....#.#...#...#.......#...#...#.#...........###...#...#...#.#.#.#...#.#.###...#.#####################...#########.......#...#...#
#######.#######.#.#########.#############.#.#.#####################.###.#.#.#####.#.#####.#.#######################################.#.###.###
###...#.....#...#.......#...#...###.....#...#...#...........#...###...#.#.#.#...#...#.....#.###...###E###########################S..#...#...#
###.#.#####.#.#########.#.###.#.###.###.#######.#.#########.#.#.#####.#.#.#.#.#.#####.#####.###.#.###.#################################.###.#
#...#...#...#...###...#...#...#...#...#...#...#...#.......#...#...#...#.#.#...#.....#.......#...#.....#######...###...###.......###...#.#...#
#.#####.#.#####.###.#.#####.#####.###.###.#.#.#####.#####.#######.#.###.#.#########.#########.###############.#.###.#.###.#####.###.#.#.#.###
#.....#.#.....#...#.#...###.#...#.....###.#.#.#...#...#...#.......#...#.#...#...#...###...#...#...#...#####...#.....#...#...#...#...#...#...#
#####.#.#####.###.#.###.###.#.#.#########.#.#.#.#.###.#.###.#########.#.###.#.#.#.#####.#.#.###.#.#.#.#####.###########.###.#.###.#########.#
###...#.......#...#.#...#...#.#.#.......#.#.#.#.#.#...#...#.......###.#...#.#.#.#.###...#...#...#.#.#.#.....#...#.......#...#.....#.......#.#
###.###########.###.#.###.###.#.#.#####.#.#.#.#.#.#.#####.#######.###.###.#.#.#.#.###.#######.###.#.#.#.#####.#.#.#######.#########.#####.#.#
#...#.....#...#.....#...#.....#...#.....#.#.#...#...#...#.#.......#...#...#...#.#.#...#.....#.#...#.#...#.....#.#.....###.#.........#...#...#
#.###.###.#.#.#########.###########.#####.#.#########.#.#.#.#######.###.#######.#.#.###.###.#.#.###.#####.#####.#####.###.#.#########.#.#####
#...#.###...#.........#.#...#.......#...#.#...#.....#.#.#.#.......#...#.#...###...#.....###.#.#.....#.....#...#.....#.....#.#...###...#.....#
###.#.###############.#.#.#.#.#######.#.#.###.#.###.#.#.#.#######.###.#.#.#.###############.#.#######.#####.#.#####.#######.#.#.###.#######.#
#...#.#...............#.#.#.#.......#.#.#.....#...#...#.#.#.......###...#.#...###.........#.#.#.....#.......#...#...#.....#...#.....#.......#
#.###.#.###############.#.#.#######.#.#.#########.#####.#.#.#############.###.###.#######.#.#.#.###.###########.#.###.###.###########.#######
#.....#...........#...#...#...#...#...#...#.......#.....#...###...###...#...#.....#...#...#...#...#...#.....#...#.#...###.#.........#.......#
#################.#.#.#######.#.#.#######.#.#######.###########.#.###.#.###.#######.#.#.#########.###.#.###.#.###.#.#####.#.#######.#######.#
#.........#.......#.#.#.....#...#.........#.......#.............#...#.#.###.....#...#...#####...#...#.#...#.#...#.#...#...#.....###.#.......#
#.#######.#.#######.#.#.###.#####################.#################.#.#.#######.#.###########.#.###.#.###.#.###.#.###.#.#######.###.#.#######
#.....#...#.........#.#...#...#.............###...#...#.....#...#...#.#...#.....#.....#...#...#.....#.....#.#...#.#...#...#.....#...#...#...#
#####.#.#############.###.###.#.###########.###.###.#.#.###.#.#.#.###.###.#.#########.#.#.#.###############.#.###.#.#####.#.#####.#####.#.#.#
###...#...............#...###...#...........#...#...#.#...#.#.#.#.#...#...#.....#...#...#.#.........#.....#.#...#.#.#.....#.....#.....#...#.#
###.###################.#########.###########.###.###.###.#.#.#.#.#.###.#######.#.#.#####.#########.#.###.#.###.#.#.#.#########.#####.#####.#
#...#.................#.#.......#...###...###.#...###...#.#...#.#.#...#.#...#...#.#.......#...#...#...#...#.....#.#.#.....#...#.....#.#...#.#
#.###.###############.#.#.#####.###.###.#.###.#.#######.#.#####.#.###.#.#.#.#.###.#########.#.#.#.#####.#########.#.#####.#.#.#####.#.#.#.#.#
#.#...###...........#...#...#...###.....#.....#...#...#...#...#...#...#...#.#...#...###...#.#...#.....#.....#...#.#.....#.#.#.#.....#.#.#.#.#
#.#.#####.#########.#######.#.###################.#.#.#####.#.#####.#######.###.###.###.#.#.#########.#####.#.#.#.#####.#.#.#.#.#####.#.#.#.#
#.#.#...#...#.....#...#.....#...###.........#...#...#.#...#.#...###.......#.###...#.#...#.#.#...#...#.#.....#.#.#.......#...#...#...#...#.#.#
#.#.#.#.###.#.###.###.#.#######.###.#######.#.#.#####.#.#.#.###.#########.#.#####.#.#.###.#.#.#.#.#.#.#.#####.#.#################.#.#####.#.#
#...#.#.###...###...#.#.......#...#.......#.#.#.......#.#...#...#.........#...#...#...#...#...#...#.#.#.......#...#...###.........#.....#...#
#####.#.###########.#.#######.###.#######.#.#.#########.#####.###.###########.#.#######.###########.#.###########.#.#.###.#############.#####
###...#.#.....#...#.#.###...#...#.#.......#...###...#...#...#...#...........#.#...#.....###.....#...#...#.........#.#.....#.............#...#
###.###.#.###.#.#.#.#.###.#.###.#.#.#############.#.#.###.#.###.###########.#.###.#.#######.###.#.#####.#.#########.#######.#############.#.#
#...#...#...#...#.#.#.#...#.....#...#...#...###...#...#...#...#.#...#.......#.#...#.......#...#.#.....#.#.......###.#.....#.............#.#.#
#.###.#####.#####.#.#.#.#############.#.#.#.###.#######.#####.#.#.#.#.#######.#.#########.###.#.#####.#.#######.###.#.###.#############.#.#.#
#...#.....#.#...#.#.#.#.#...#...#.....#...#...#...#.....#...#...#.#.#.......#.#...#.......#...#...#...#.........#...#...#...............#.#.#
###.#####.#.#.#.#.#.#.#.#.#.#.#.#.###########.###.#.#####.#.#####.#.#######.#.###.#.#######.#####.#.#############.#####.#################.#.#
###...#...#...#.#...#...#.#...#...#...........#...#.....#.#...#...#.#...#...#.....#.###...#.....#.#...#...###.....#...#.###...###.....#...#.#
#####.#.#######.#########.#########.###########.#######.#.###.#.###.#.#.#.#########.###.#.#####.#.###.#.#.###.#####.#.#.###.#.###.###.#.###.#
#.....#.........#...#...#.#.......#.............#...#...#.#...#...#.#.#.#.......#...#...#...#...#...#...#.....#...#.#.#.....#...#...#.#...#.#
#.###############.#.#.#.#.#.#####.###############.#.#.###.#.#####.#.#.#.#######.#.###.#####.#.#####.###########.#.#.#.#########.###.#.###.#.#
#.#...#.........#.#...#...#.....#.#...............#...###.#.#.....#.#.#.#.......#...#.#.....#.....#...#.....#...#...#...........###.#...#.#.#
#.#.#.#.#######.#.#############.#.#.#####################.#.#.#####.#.#.#.#########.#.#.#########.###.#.###.#.#####################.###.#.#.#
#.#.#...#.......#.#.............#...#.....#...###.....#...#.#.....#.#.#.#.....#.....#.#.#...#...#...#.#...#.#...............#.......#...#.#.#
#.#.#####.#######.#.#################.###.#.#.###.###.#.###.#####.#.#.#.#####.#.#####.#.#.#.#.#.###.#.###.#.###############.#.#######.###.#.#
#...#...#.....#...#...................#...#.#...#.#...#...#...###.#.#.#.#.....#...#...#.#.#.#.#.###.#.....#.................#.#.....#.....#.#
#####.#.#####.#.#######################.###.###.#.#.#####.###.###.#.#.#.#.#######.#.###.#.#.#.#.###.#########################.#.###.#######.#
#.....#.......#.#.....###...#...........###...#.#.#.....#.#...#...#.#.#.#.....#...#...#.#.#.#.#...#...........................#...#...#...#.#
#.#############.#.###.###.#.#.###############.#.#.#####.#.#.###.###.#.#.#####.#.#####.#.#.#.#.###.###############################.###.#.#.#.#
#...............#...#.....#...#.....#...#...#.#.#...#...#.#.###...#.#.#.#...#.#.#####.#.#.#.#.#...###...#...............#.........###.#.#.#.#
###################.###########.###.#.#.#.#.#.#.###.#.###.#.#####.#.#.#.#.#.#.#.#####.#.#.#.#.#.#####.#.#.#############.#.###########.#.#.#.#
#...#.......#.......#...........#...#.#.#.#.#.#...#.#.#...#...#...#.#.#.#.#...#...#...#.#.#.#.#...#...#.#.............#.#...#...#...#...#.#.#
#.#.#.#####.#.#######.###########.###.#.#.#.#.###.#.#.#.#####.#.###.#.#.#.#######.#.###.#.#.#.###.#.###.#############.#.###.#.#.#.#.#####.#.#
#.#.#...#...#.........#...........#...#...#.#...#.#.#.#.....#...###.#.#.#.......#.#.#...#.#.#.#...#.#...#.....#.....#.#...#...#...#...###.#.#
#.#.###.#.#############.###########.#######.###.#.#.#.#####.#######.#.#.#######.#.#.#.###.#.#.#.###.#.###.###.#.###.#.###.###########.###.#.#
#.#.....#.###...###...#...#.....#...###.....#...#.#.#...#...#.......#.#...#...#.#.#.#...#.#.#.#.....#.#...###...###...###...#...#...#...#...#
#.#######.###.#.###.#.###.#.###.#.#####.#####.###.#.###.#.###.#######.###.#.#.#.#.#.###.#.#.#.#######.#.###################.#.#.#.#.###.#####
#.#.....#.....#.....#.....#.#...#.....#.....#.#...#...#.#.#...#.....#...#.#.#.#.#...###.#.#.#.#.......#...#.........#...#...#.#.#.#...#...###
#.#.###.###################.#.#######.#####.#.#.#####.#.#.#.###.###.###.#.#.#.#.#######.#.#.#.#.#########.#.#######.#.#.#.###.#.#.###.###.###
#.#.###.#...#.....#...#...#.#...#...#.....#.#.#...#...#.#.#...#...#.#...#...#.#.......#...#.#.#.......#...#.#.......#.#.#...#.#.#.###...#...#
#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.#####.#.#.###.#.###.#.###.###.#.#.#######.#######.#####.#.#######.#.###.#.#######.#.###.#.#.#.#####.###.#
#.#.#...#.#.#.###.#.#.#.#.#.#...#.#.#.....#...#...#...#.#.#...#...#.#.#.......#.....#...###.#.#.......#.....#.......#.#...#.#.#.#...###...#.#
#.#.#.###.#.#.###.#.#.#.#.#.#.###.#.#.#########.#####.#.#.#.###.###.#.#.#######.###.###.###.#.#.###################.#.###.#.#.#.###.#####.#.#
#.#.#.....#.#.#...#.#.#.#.#.#...#.#.#.....#.....#.....#...#...#.###.#.#.#.....#...#.#...#...#.#...#...#...#.......#...#...#.#.#...#.....#.#.#
#.#.#######.#.#.###.#.#.#.#.###.#.#.#####.#.#####.###########.#.###.#.#.#.###.###.#.#.###.###.###.#.#.#.#.#.#####.#####.###.#.###.#####.#.#.#
#...#.......#.#.#...#...#...#...#.#.#.....#.....#...###.......#...#.#.#...#...#...#...###...#.#...#.#.#.#...###...#.....###...###.#...#.#.#.#
#####.#######.#.#.###########.###.#.#.#########.###.###.#########.#.#.#####.###.###########.#.#.###.#.#.#######.###.#############.#.#.#.#.#.#
#.....#...#...#.#...#.........#...#.#.........#...#...#...#...#...#...#...#...#.........#...#.#...#.#.#.......#...#.............#.#.#.#.#...#
#.#####.#.#.###.###.#.#########.###.#########.###.###.###.#.#.#.#######.#.###.#########.#.###.###.#.#.#######.###.#############.#.#.#.#.#####
#...#...#.#.#...#...#.........#.#...#.........###...#...#.#.#.#.#.....#.#.###.#.........#...#...#.#.#.#.......###.#.........#...#.#.#.#.....#
###.#.###.#.#.###.###########.#.#.###.#############.###.#.#.#.#.#.###.#.#.###.#.###########.###.#.#.#.#.#########.#.#######.#.###.#.#.#####.#
###.#.#...#.#...#.#...###.....#.#...#.........#.....#...#.#.#.#.#...#...#.....#.....#...###...#.#.#.#.#...#.......#.......#.#...#...#...#...#
###.#.#.###.###.#.#.#.###.#####.###.#########.#.#####.###.#.#.#.###.###############.#.#.#####.#.#.#.#.###.#.#############.#.###.#######.#.###
#...#.#.....###.#.#.#.#...#...#.###.#.......#.#.#...#.#...#.#.#...#...#...#...#...#...#.#...#.#.#.#.#...#.#.....#.....#...#.#...###.....#...#
#.###.#########.#.#.#.#.###.#.#.###.#.#####.#.#.#.#.#.#.###.#.###.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.###.#.#####.#.###.#.###.#.#####.#######.#
#...#...#.......#...#.#...#.#.#.#...#.....#...#...#.#.#...#.#...#...#...#.#.#.#.#.#...#...#.#...#.#.###.#.....#.#...#.#.###...#...#.#.....#.#
###.###.#.###########.###.#.#.#.#.#######.#########.#.###.#.###.###.#####.#.#.#.#.#.#.#####.#####.#.###.#####.#.###.#.#.#######.#.#.#.###.#.#
#...#...#...#...#...#...#...#.#.#...#...#.....#.....#.#...#...#.....#.....#.#...#...#.#...#...###.#...#.#...#.#.#...#...#...#...#.#.#...#...#
#.###.#####.#.#.#.#.###.#####.#.###.#.#.#####.#.#####.#.#####.#######.#####.#########.#.#.###.###.###.#.#.#.#.#.#.#######.#.#.###.#.###.#####
#...#...###...#.#.#.#...#.....#.###.#.#.#.....#.......#...#...#.......#...#.#.........#.#...#...#...#.#.#.#...#.#.........#...#...#.#...#...#
###.###.#######.#.#.#.###.#####.###.#.#.#.###############.#.###.#######.#.#.#.#########.###.###.###.#.#.#.#####.###############.###.#.###.#.#
###...#.#.......#.#.#...#.......#...#.#.#...............#...#...#...#...#.#.#.......#...#...#...###...#.#.....#...#...#.....#...###.#.###.#.#
#####.#.#.#######.#.###.#########.###.#.###############.#####.###.#.#.###.#.#######.#.###.###.#########.#####.###.#.#.#.###.#.#####.#.###.#.#
#.....#.#...#...#.#.#...#.........#...#...#...#...#...#.#.....#...#.#.#...#.#.......#...#.#...#.........#...#.#...#.#.#...#.#...#...#.....#.#
#.#####.###.#.#.#.#.#.###.#########.#####.#.#.#.#.#.#.#.#.#####.###.#.#.###.#.#########.#.#.###.#########.#.#.#.###.#.###.#.###.#.#########.#
#.......###...#...#...###...........#####...#...#...#...#.......###...#.....#...........#...###...........#...#.....#.....#.....#...........#
#############################################################################################################################################"#;
